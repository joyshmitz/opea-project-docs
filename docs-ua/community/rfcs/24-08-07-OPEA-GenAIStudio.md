# 24-08-07 OPEA-001 OPEA GenAIStudio

## Автори

[ongsoonee](https://github.com/OngSoonEe)
[chinyixiang](https://github.com/chinyixiang)

## Статус

На розгляді

## Зміст RFC 

### Мета

Мета цього RFC - запропонувати створення GenAI Studio, платформи, призначеної для полегшення розробки користувацьких додатків на основі великих мовних моделей (LLM), використовуючи ідеї, отримані на етапі експериментів на ігровому майданчику. GenAI Studio дозволить користувачам створювати, оцінювати та порівнювати свої LLM-додатки за допомогою зручного інтерфейсу без коду/з низьким вмістом коду. Платформа також надає можливість експортувати розроблений додаток як готовий до розгортання пакет для негайної інтеграції на підприємстві. Ця ініціатива спрямована на спрощення переходу від концепції до виробництва, забезпечуючи безперебійний процес розгортання корпоративних додатків "з нуля".

### Мотивація

Цей RFC описує створення Enterprise GenAI Assembly Framework, спрощеної платформи для користувачів OPEA. Ключові цілі фреймворку включають:
- Збірка та конфігурація: Спростіть процес складання та конфігурації компонентів GenAI, таких як GenAIComps, за допомогою інтерактивного інтерфейсу для створення функціональних додатків.
- Бенчмаркінг та оцінка: Проведення порівняльне тестування та оцінку програми для налаштування та оптимізації, включаючи використання засобів [GenAIEval](https://github.com/opea-project/GenAIEval).
- Створення пакету розгортання підприємства: Надання інструментів для створення готових до розгортання корпоративних пакетів, включно з інтеграцією [GenAIInfra](https://github.com/opea-project/GenAIInfra).

Фреймворк призначений для демократизації розробки, оцінки і розгортання додатків GenAI для користувачів OPEA, сприяючи інноваціям і підвищенню операційної ефективності в корпоративному ландшафті ШІ з OPEA.

### Ціннісна пропозиція
#### Поточний підхід
![Current Approach of GenAI Solution for enterprise](https://github.com/user-attachments/assets/adb10f29-b506-46d6-abd3-ed5f70049bee)

Днів/тижнів до 1-го робочого рішення

#### Підхід GenAI Studio
![Proposed GenAIStudio Approach](https://github.com/user-attachments/assets/e0c59dd2-0ff5-4deb-9561-8cba4ab5defe)

Рішення Day-0, яке пропонує користувачам фундаментальний скелет, що дозволяє їм зосередитися на бізнес-кейсах, а не на створенні базового фреймворку.

### Особа
OPEA - це фреймворк, призначений для оптимізації автоматизації процесів на підприємстві за допомогою низки мікросервісів. GenAI Studio розширює можливості OPEA, дозволяючи користувачам розробляти, розгортати та оптимізувати рішення на основі штучного інтелекту. Цей сценарій демонструє, як різні особи - розробники OPEA, корпоративні користувачі (DevOps) та кінцеві користувачі - можуть використовувати GenAI Studio для ефективного створення та розгортання готових рішень для підприємств.

Сценарії:

1. Особа Розробник
   - Мета:Розробка та інтеграція додатку GenAI для конкретного бізнес-кейсу в рамках мікросервісної архітектури OPEA.
   - Використання Studio:
     - Розробник OPEA використовує GenAI Studio для створення моделі GenAI, яка допомагає покращити бізнес-кейс використання.
     - Просунуті інструменти розробки Studio дозволяють розробнику точно налаштовувати модель на основі специфічних даних підприємства, забезпечуючи оптимальну продуктивність.
     - Після розробки Studio автоматично генерує готовий до використання корпоративний пакет розгортання, який включає всі необхідні компоненти, такі як конфігурації та інструменти управління ресурсами, що забезпечує безперешкодну інтеграцію з існуючою інфраструктурою OPEA.
     - Цей пакет розроблений таким чином, щоб його можна було легко розгорнути на сайті замовника, мінімізуючи потребу в додатковій конфігурації та налаштуванні.

2. Особа Користувач на підприємстві
   - Мета: Оптимізація та розгортання додатку GenAI з мікросервісами OPEA для задоволення конкретних потреб підприємства.
   - Використання Studio:
     - Користувач на підприємстві використовує GenAI Studio для тестування та оптимізації згенерованого пакета розгортання.
     - За допомогою інструментів бенчмаркінгу Studio вони оцінюють продуктивність ШІ-моделі як з точки зору висновків, так і з точки зору обчислень, щоб переконатися, що вона відповідає операційним вимогам підприємства.
     - Studio надає інформацію про розподіл ресурсів, допомагаючи DevOps точно налаштувати розгортання для досягнення найкращої продуктивності. Після оптимізації пакет розгортання легко запускається, дозволяючи підприємству негайно отримати вигоду від удосконалень ШІ.

3. Особа Кінцевий користувач
   - Мета: Впровадження і використання рішень OPEA зі штучним інтелектом для конкретних бізнес-завдань.
   - Використання Studio:
     - Кінцевий користувач отримує доступ до GenAI Studio, щоб вивчити готовий до використання пакет розгортання, наданий командою DevOps.
     - Студія пропонує інструменти для оцінки продуктивності рішення в реальних сценаріях, щоб переконатися, що воно відповідає цілям бізнесу.
     - Після мінімального налаштування кінцевий користувач може розгорнути рішення зі штучним інтелектом у своєму середовищі, автоматизуючи складні робочі процеси та оптимізуючи використання ресурсів для більш ефективного досягнення бізнес-цілей.

Generative AI Studio дозволяє розробникам, корпоративним користувачам і кінцевим користувачам створювати, оптимізувати і розгортати корпоративні рішення на основі штучного інтелекту без особливих зусиль. Надаючи інструменти для створення готових до використання пакетів розгортання та тестування продуктивності, студія гарантує, що рішення на основі штучного інтелекту не лише потужні, але й прості у розгортанні та обслуговуванні, що робить їх високоефективними для бізнес-застосунків.

### Стратегія та обсяг робіт

Не вигадуйте колесо - використовуйте вже існуючі напрацювання OPEA, відкриті джерела та фундаментальні напрацювання EasyData.
- GMC на конфігурацію/розгортання
- Langflow/flowise.ai для налаштування додатку
- Пакети для оцінки продуктивності (VictoriaMetric, OpenTelemetry (Otel), Tempo, Loki, Grafana)
- Istio для управління навантаженням

Обсяг розробки/оптимізації моделі

| Обсяг роботи | Статус |
| --- | --- |
| Prompt engineering, RAG | За обсягом |
| Model Finetune | Пряма ціль |
| Model Pre-train | Поза сферою дії |

### Архітектура високого рівня GenAI Studio
![OPEA GenAI Studio Architecture](https://github.com/user-attachments/assets/fa55aeae-158b-4035-8325-25821c24a27f)

### Проєктна пропозиція

### Проєктний простір
Надання інтерактивного користувацького інтерфейсу для створення, налаштування, тестування і генерації остаточного пакета розгортання. Користувач може використовувати файл даних yaml для створення та модифікації студійного проекту, як альтернативу графічному інтерфейсу.

#### Частина 1: Побудова та конфігурація додатку
Користувач може створити додаток GenAI з такою конфігурацією, як
- вибір моделі
- встановлення параметрів моделі (temp, top-p, top-k, max response)
- системна інструкція

Забезпечує 2 режими конфігурації
- Режим Wizard: Користувач отримує покрокову інструкцію щодо створення додатку
    ![screenshot sample of wizard mode](https://github.com/user-attachments/assets/1c780be1-d6dc-47fb-8a23-5229392ab45b)
- Режим робочого процесу Drag-n-Drop: Дозволяє користувачеві створити власний потік з доступних компонентів (використовуючи Flowise AI)
    - Utilize Flowise AI - https://docs.flowiseai.com/
    - Примітка: Потребує подальшої доцільності навчання в області
        - Простота налаштування або додавання нових компонентів інтерфейсу
        - Підключення та інтеграція з Мегасервісом (HelmChart, DockerCompose, GMC)



#### Частина 2: Порівняльний аналіз та оцінка
A. Продуктивність виведення
- Загальний бенчмаркінг
    - GLUE/SuperGLUE
    - GPQA
    - SQuAD
    - ImageNet
    - MLPerf
- Галюцинація
- Вертикальний/доменний бенчмаркінг (з базовою інформацією)
- Доопрацювання - наступний етап

B. Модель обчислювальної продуктивності
- токенів на секунду (TPS)
- затримка 1-го токена
- пропускна здатність
- продуктивність RAG

C. Моніторинг ресурсів - завантаження процесора, пам'яті
![Diagram on resource monitoring architecture](https://github.com/user-attachments/assets/0fe9fed7-0979-4325-b242-fcd753b19f09)

Включення компонентів для оцінки продуктивності обчислень
- VictoriaMetric: як сховище метрик для використання ресурсів
- OpenTelemetry (Otel): механізм трасування датчиків
- Tempo: сховище трас для OpenTelemetry
- Loki:  зберігання логів для pod/Kubernetes
- Grafana: візуалізація метрик, трасування та логів
- Prometheus

#### Частина 3: Розгортання на підприємстві
Створіть базу корпоративного пакета розгортання на основі програми з функціями корпоративних об'єктів, включно з функціями:
- Інтерфейс додатку
- Керування користувачами (вхід, створення, покращення, видалення)
- Керування сеансами (наприклад, сеансами чату)
- налаштування параметрів виведення (top-p, top-k, температура)
- Vector Store
- Генерація токенів
- Доступ до API

Додатки:
- QnA
- AudioChat
- VisualChat
- Translation
- CodeGen
- CodeTrans
- Summarizer

Конфігурація розгортання - Зразок інтерфейсу
- ОС
- Хмара/ OnPrem
- Кластер /одна машина
- Вибір функцій (API доступ, Керування користувачами тощо)
- Моніторингова панель для управління ресурсами

![GenAI Deployment Package Configuration](https://github.com/user-attachments/assets/8dd43bff-26a6-4c3e-a80c-127bccdff7f3)

Згенерований пакунок розгортання зазвичай складається з таких частин:
- Плейбуки Ansible - Плейбуки Ansible будуть використовуватися для налаштування та ініціалізації важливих служб, таких як K8s, база даних SQL, локальний реєстр образів тощо.
- Коди інтерфейсу додатку
- Внутрішні коди серверів додатків
- Інші образи компонентів мікросервісу OPEA можна отримати з реєстру OPEA безпосередньо під час налаштування.


### Сумісність
Цей RFC вимагатиме проведення техніко-економічного обґрунтування щодо інструментів, які слід використовувати для проектування режиму Drag-n-Drop Workflow у Частині 1. Flowise AI є хорошим кандидатом, але його потрібно запускати як окремий сервіс, що додасть складності до UI/UX дизайну.
